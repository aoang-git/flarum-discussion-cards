{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@walsgit/flarum-discussion-cards/webpack/bootstrap","webpack://@walsgit/flarum-discussion-cards/webpack/runtime/compat get default export","webpack://@walsgit/flarum-discussion-cards/webpack/runtime/define property getters","webpack://@walsgit/flarum-discussion-cards/webpack/runtime/hasOwnProperty shorthand","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['app']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['extend']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['forum/components/DiscussionList']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['forum/states/DiscussionListState']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/components/Placeholder']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/components/Button']\"","webpack://@walsgit/flarum-discussion-cards/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@walsgit/flarum-discussion-cards/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/Component']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/components/Tooltip']\"","webpack://@walsgit/flarum-discussion-cards/./src/forum/utils/craftBadges.js","webpack://@walsgit/flarum-discussion-cards/./src/forum/helpers/isValideImageUrl.js","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/components/Link']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['tags/utils/sortTags']\"","webpack://@walsgit/flarum-discussion-cards/./src/forum/utils/craftTags.js","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/utils/humanTime']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/components/Dropdown']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['forum/utils/DiscussionControls']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/utils/string']\"","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/helpers/avatar']\"","webpack://@walsgit/flarum-discussion-cards/./src/forum/components/LastReplies.js","webpack://@walsgit/flarum-discussion-cards/./src/forum/helpers/compareTags.js","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['components/TerminalPost']\"","webpack://@walsgit/flarum-discussion-cards/./src/forum/components/CardItem.js","webpack://@walsgit/flarum-discussion-cards/./src/forum/helpers/getPostImage.js","webpack://@walsgit/flarum-discussion-cards/external root \"flarum.core.compat['common/utils/abbreviateNumber']\"","webpack://@walsgit/flarum-discussion-cards/./src/forum/components/ListItem.js","webpack://@walsgit/flarum-discussion-cards/./src/forum/helpers/highlightHashtags.js","webpack://@walsgit/flarum-discussion-cards/./src/forum/helpers/getPostImages.js","webpack://@walsgit/flarum-discussion-cards/./src/forum/helpers/checkOverflowingTags.js","webpack://@walsgit/flarum-discussion-cards/./src/forum/compat.js","webpack://@walsgit/flarum-discussion-cards/external assign \"flarum.core\"","webpack://@walsgit/flarum-discussion-cards/./src/forum/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/states/DiscussionListState'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Placeholder'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Tooltip'];","import icon from 'flarum/common/helpers/icon';\r\nimport Tooltip from 'flarum/common/components/Tooltip';\r\n\r\nexport default function craftBadges(badges) {\r\n  if (badges.length) {\r\n    return [m('.cardBadges', [badges.map((badge) => {\r\n      return [\r\n        m(Tooltip, {\r\n          text: badge.attrs.label ? badge.attrs.label[0] : '',\r\n          position: 'right'\r\n        },\r\n        m('span.cardBadge.Badge.Badge--' + badge.attrs.type, [icon(badge.attrs.icon)]))]\r\n    })])];\r\n  }\r\n};\r\n","export default function isValideImageUrl (url) {\r\n    if(typeof url !== 'string') return false;\r\n    \r\n    const imageExtensions = ['jpg', 'jpeg', 'png', 'gif', 'webp', 'bmp', 'svg'];\r\n\r\n    if (!url.startsWith('http://') && !url.startsWith('https://')) {\r\n        url = 'http://' + url;\r\n    }\r\n\r\n    let parsedUrl;\r\n    try {\r\n        parsedUrl = new URL(url);\r\n    } catch {\r\n        return false;\r\n    }\r\n\r\n    const extension = parsedUrl.pathname.split('.').pop().toLowerCase();\r\n    return imageExtensions.includes(extension);\r\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['tags/utils/sortTags'];","import Link from 'flarum/common/components/Link';\r\nimport sortTags from 'flarum/tags/utils/sortTags';\r\n\r\nexport default function craftTags(tags) {\r\n  if (tags) {\r\n    return [sortTags(tags).map(function (tag) {\r\n      return [\r\n        <Link className=\"cardTag\"\r\n              style={{backgroundColor: tag.color()}}\r\n              href={app.route('tag', {tags: tag.slug()})}>\r\n          {tag.name()}\r\n        </Link>\r\n      ]\r\n    })];\r\n  }\r\n};\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/humanTime'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/username'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Dropdown'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/DiscussionControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/string'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/avatar'];","import Component from 'flarum/common/Component';\r\nimport avatar from 'flarum/common/helpers/avatar';\r\n\r\n\r\nexport default class LastReplies extends Component {\r\n\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n    this.discussion = this.attrs.discussion;\r\n  }\r\n\r\n  view() {\r\n    const discussion = this.discussion;\r\n\r\n    // let's assume that the last 10 posts will be enough for us to identify 3 unique users\r\n    const posts = discussion.posts().splice(-10);\r\n\r\n    const filteredPosts = posts\r\n      .filter((post) => {\r\n        return !post.isHidden() && post.number() !== 1 && post.contentType() === \"comment\";\r\n      })\r\n      .sort((a, b) => b.createdAt() - a.createdAt());\r\n\r\n    const groupedUsers = filteredPosts\r\n      .map(post => post.user())\r\n      .filter((user, i, self) => {\r\n        return self.indexOf(user) === i\r\n      })\r\n      .reverse()\r\n      // last 3 users\r\n      .splice(-3);\r\n\r\n\r\n    return groupedUsers.map(user => {\r\n      return avatar(user, {className: 'Avatar--mini'})\r\n    })\r\n\r\n  }\r\n\r\n}\r\n","export default function compareTags(currentTag, priorityTag) {\r\n    if (currentTag.isChild && !priorityTag.isChild) return -1;\r\n    if (!currentTag.isChild && priorityTag.isChild) return 1;\r\n    if (currentTag.isChild && priorityTag.isChild && currentTag.parent === priorityTag.parent) return currentTag.position - priorityTag.position;\r\n    if (currentTag.isChild && priorityTag.isChild && currentTag.parent !== priorityTag.parent) return currentTag.parent - priorityTag.parent;\r\n\r\n    if (!currentTag.position && priorityTag.position) return 1;\r\n    if (currentTag.position && !priorityTag.position) return -1;\r\n    if (currentTag.position && priorityTag.position) return currentTag.position - priorityTag.position;\r\n    return currentTag.id - priorityTag.id;\r\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['components/TerminalPost'];","import Component from \"flarum/common/Component\";\r\nimport craftBadges from \"../utils/craftBadges\";\r\nimport getPostImage from \"../helpers/getPostImage\";\r\nimport craftTags from \"../utils/craftTags\";\r\nimport humanTime from \"flarum/common/utils/humanTime\";\r\nimport icon from \"flarum/common/helpers/icon\";\r\nimport username from \"flarum/common/helpers/username\";\r\nimport Dropdown from \"flarum/common/components/Dropdown\";\r\nimport DiscussionControls from \"flarum/forum/utils/DiscussionControls\";\r\nimport Link from \"flarum/common/components/Link\";\r\nimport { truncate } from \"flarum/common/utils/string\";\r\nimport LastReplies from \"./LastReplies\";\r\nimport compareTags from \"../helpers/compareTags\";\r\nimport isValideImageUrl from \"../helpers/isValideImageUrl\";\r\nimport TerminalPost from 'flarum/components/TerminalPost';\r\n\r\nexport default class cardItem extends Component {\r\n\toninit(vnode) {\r\n\t\tsuper.oninit(vnode);\r\n\t\tthis.discussion = this.attrs.discussion;\r\n\t}\r\n\r\n\tview() {\r\n\t\tconst discussion = this.discussion;\r\n\t\tconst settings = {};\r\n\t\tfor (const key in app.forum.data.attributes) {\r\n\t\t\tif (key.startsWith('walsgitDiscussionCards')) {\r\n\t\t\t\tlet newKey = key.replace('walsgitDiscussionCards', '');\r\n\t\t\t\tnewKey = newKey.replace(/^./, newKey.charAt(0).toLowerCase());\r\n\t\t\t\tsettings[newKey] = app.forum.data.attributes[key];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/* Getting & setting relevant info for 3rd party Views extensions support: Flarumite and MichaelBelgium */\r\n\t\tconst viewsActivated = 'flarumite-simple-discussion-views' in flarum.extensions;\r\n\t\tconst isViewsSet = discussion.data.attributes.hasOwnProperty('views');\r\n\r\n\t\tconst mbViewsActivated = 'michaelbelgium-discussion-views' in flarum.extensions;\r\n\t\tconst isViewCountSet = discussion.data.attributes.hasOwnProperty('viewCount');\r\n\r\n\t\tconst viewsCount = viewsActivated && isViewsSet ? discussion.views() : mbViewsActivated && isViewCountSet ? discussion.viewCount() : NaN;\r\n\r\n\t\t/* Getting & setting relevant info for 3rd party Flarum Blog extension support */\r\n\t\tconst blogActivated = app.forum.data.attributes.hasOwnProperty('blogTags');\r\n\t\tconst blogSettings = {};\r\n\t\tconst postIsBlogType = discussion.data.relationships.hasOwnProperty('blogMeta');\r\n\t\tconst blogPost = {}\r\n\t\tif(blogActivated) {\r\n\t\t\tblogSettings.tags = app.forum.attribute('blogTags');\r\n\t\t\tblogSettings.defaultImage = app.forum.attribute('blogDefaultImage');\r\n\r\n\t\t\tif(postIsBlogType) {\r\n\t\t\t\tconst blogPostsData = discussion.store.data.blogMeta[discussion.data.relationships.blogMeta.data.id];\r\n\t\t\t\tif(isValideImageUrl(blogPostsData.attribute('featuredImage'))) {\r\n\t\t\t\t\tblogPost.featuredImage = blogPostsData.attribute('featuredImage');\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/* Getting & setting relevant info for 3rd party Repost extension */\r\n\t\tconst repostActivated = 'shebaoting-repost' in flarum.extensions;\r\n\t\tconst repostUrl = discussion.data.attributes.original_url || null;\r\n\r\n\t\tconst isTagPage = m.route.get().split('?')[0].startsWith('/t/');\r\n\t\tlet tagId;\r\n\t\tif (isTagPage) {\r\n\t\t\tconst slug = m.route.get().split('/t/')[1]?.split('?')[0];\r\n\t\t\ttagId = app.store.all('tags').find(t => t.slug() === slug).data.id;\r\n\t\t\tconst tag = app.store.all('tags').find(t => t.id() === tagId);\r\n\t\t\tconst tagSettings = tag ? JSON.parse(tag.data.attributes.walsgitDiscussionCardsTagSettings || '{}') : {};\r\n\t\t\tconst tagImage = tag ? tag.data.attributes.walsgitDiscussionCardsTagDefaultImage : null;\r\n\t\t\t\r\n\t\t\ttagSettings.defaultImage = tagImage;\r\n\t\t\t/* In case Flarum Blog Extension and useBlogImage are activated  */\r\n\t\t\tif(blogActivated && Number(settings.useBlogImages) === 1 && blogSettings.tags.includes(tagId)) {\r\n\t\t\t\ttagSettings.defaultImage = postIsBlogType && blogPost.featuredImage && isValideImageUrl(blogPost.featuredImage) ? blogPost.featuredImage : blogSettings.defaultImage;\r\n\t\t\t}\r\n\r\n\t\t\tfor (const key in tagSettings) {\r\n\t\t\t\tif (settings.hasOwnProperty(key) && tagSettings[key] !== settings[key] && tagSettings[key] !== null) {\r\n\t\t\t\t\tsettings[key] = tagSettings[key];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/* On the IndexPage (all discussions) checks which default image to show based on tag priority */\r\n\t\tconst isIndexPage = m.route.get().split('?')[0] === '/';\r\n\t\tif (isIndexPage) {\r\n\t\t\tconst tags = discussion.tags();\r\n\t\t\tfor (const key in tags) {\r\n\t\t\t\tconst tagId = tags[key].id();\r\n\t\t\t\tconst isChild = tags[key].isChild();\r\n\t\t\t\tconst parent = tags[key].data.hasOwnProperty('relationships') && tags[key].parent() ? tags[key].parent()['data'].id : null;\r\n\t\t\t\tconst position = tags[key].position();\r\n\r\n\t\t\t\tlet tagCustomImg = tags[key].attribute('walsgitDiscussionCardsTagDefaultImage');\r\n\t\t\t\t/* In case Flarum Blog Extension and useBlogImage are activated  */\r\n\t\t\t\tif(blogActivated && Number(settings.useBlogImages) === 1 && blogSettings.tags.includes(tagId)) {\r\n\t\t\t\t\ttagCustomImg = postIsBlogType && blogPost.featuredImage && isValideImageUrl(blogPost.featuredImage) ? blogPost.featuredImage : blogSettings.defaultImage;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst currentTag = { id: tagId, isChild, parent, position, tagCustomImg }\r\n\t\t\t\tlet priorityTag = null;\r\n\t\t\t\tif (!settings.allowedTags.includes(tagId) || tagCustomImg === null) continue;\t\t\t\t\t\r\n\r\n\t\t\t\tif (priorityTag === null || compareTags(currentTag, priorityTag) < 0) {\r\n\t\t\t\t\tpriorityTag = { id: tagId, isChild, parent, position, tagCustomImg };\r\n\t\t\t\t\tsettings.defaultImage = tagCustomImg;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst isRead = Number(settings.markReadCards) === 1 && discussion.isRead() && app.session.user ? \"read\" : \"\";\r\n\t\tconst attrs = {};\r\n\t\tattrs.className =\r\n\t\t\t\"wrapImg\" + (Number(settings.showAuthor) === 1 ? \" After\" : \"\");\r\n\t\tconst image = getPostImage(discussion.firstPost(), settings.defaultImage, postIsBlogType);\r\n\t\tconst media = image ? (\r\n\t\t\t<img\r\n\t\t\t\tsrc={image}\r\n\t\t\t\tclassName=\"previewCardImg\"\r\n\t\t\t\talt={discussion.title()}\r\n\t\t\t\tloading=\"lazy\"\r\n\t\t\t/>\r\n\t\t) : (\r\n\t\t\t<div className=\"imgStub\" />\r\n\t\t);\r\n\r\n\t\t/* Jump to the last relevant post (first unread or last post) */\r\n\t\tconst jumpTo = Math.min(discussion.lastPostNumber() ?? 0, (discussion.lastReadPostNumber() || 0) + 1);\r\n\r\n\t\t/* setting post counts & text */\r\n\t\tconst replyText = discussion.unreadCount() \r\n\t\t\t? app.translator.trans(\"walsgit_discussion_cards.forum.unreadReplies\", { count: discussion.unreadCount()} ) \r\n\t\t\t: app.translator.trans(\"walsgit_discussion_cards.forum.replies\", { count: discussion.replyCount() || \"0\"} );\r\n\r\n\t\treturn (\r\n\t\t\t<div\r\n\t\t\t\tkey={discussion.id()}\r\n\t\t\t\tdata-id={discussion.id()}\r\n\t\t\t\tdata-tag-id={isTagPage ? tagId : null}\r\n\t\t\t\tclassName={\r\n\t\t\t\t\t\"CardsListItem Card \" +\r\n\t\t\t\t\tisRead +\r\n\t\t\t\t\t(discussion.isHidden() ? \" Hidden\" : \"\")\r\n\t\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t{DiscussionControls.controls(discussion, this).toArray().length\r\n\t\t\t\t\t? m(\r\n\t\t\t\t\t\t\tDropdown,\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\ticon: \"fas fa-ellipsis-v\",\r\n\t\t\t\t\t\t\t\tclassName: \"DiscussionListItem-controls\",\r\n\t\t\t\t\t\t\t\tbuttonClassName:\r\n\t\t\t\t\t\t\t\t\t\"Button Button--icon Button--flat Slidable-underneath Slidable-underneath--right\",\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tDiscussionControls.controls(\r\n\t\t\t\t\t\t\t\tdiscussion,\r\n\t\t\t\t\t\t\t\tthis\r\n\t\t\t\t\t\t\t).toArray()\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t: \"\"}\r\n\t\t\t\t<Link\r\n\t\t\t\t\thref={app.route.discussion(discussion, jumpTo)}\r\n\t\t\t\t\tclassName=\"cardLink\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{Number(settings.showBadges) === 1\r\n\t\t\t\t\t\t? craftBadges(discussion.badges().toArray())\r\n\t\t\t\t\t\t: \"\"}\r\n\r\n\t\t\t\t\t<div {...attrs}>\r\n\t\t\t\t\t\t{(isViewsSet || isViewCountSet) && (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t{Number(settings.showViews) === 1 &&\r\n\t\t\t\t\t\t\t\t!isNaN(viewsCount) ? (\r\n\t\t\t\t\t\t\t\t\t<div className=\"imageLabel discussionViews\">\r\n\t\t\t\t\t\t\t\t\t\t{icon(\"fas fa-eye\", { className: \"labelIcon\" })}\r\n\t\t\t\t\t\t\t\t\t\t{viewsCount}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{media}\r\n\r\n\t\t\t\t\t\t{Number(settings.showAuthor) === 1 ? (\r\n\t\t\t\t\t\t\t<div className=\"cardFoot\">\r\n\t\t\t\t\t\t\t\t<div className=\"Author\">\r\n\t\t\t\t\t\t\t\t\t{username(discussion.user())}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"Date\">\r\n\t\t\t\t\t\t\t\t\t{humanTime(discussion.createdAt())}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className=\"cardTags\">\r\n\t\t\t\t\t\t{craftTags(discussion.tags())}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"cardTitle\">\r\n\t\t\t\t\t\t<h2 title={discussion.title()} className=\"title\">\r\n\t\t\t\t\t\t\t{Number(settings.allowRepostLinks) === 1 && repostActivated && repostUrl ? <a href={repostUrl} onclick={(e) => e.stopPropagation()}>{truncate(discussion.title(), 80)}</a> : truncate(discussion.title(), 80)}\r\n\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{Number(settings.previewText) === 1 && discussion.firstPost() ? (\r\n\t\t\t\t\t\t<div className=\"previewPost\">\r\n\t\t\t\t\t\t\t{blogActivated && Number(settings.useBlogSummary) === 1 && discussion.data.relationships.hasOwnProperty('blogMeta') && discussion.blogMeta().summary() !== ''\r\n\t\t\t\t\t\t\t\t? truncate(discussion.blogMeta().summary(), 150)\r\n\t\t\t\t\t\t\t\t: truncate(discussion.firstPost().contentPlain(), 150)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{Number(settings.showLastPostInfo) === 1 && discussion.firstPost() ? (\r\n\t\t\t\t\t\t<div className=\"terminalPost\">\r\n\t\t\t\t\t\t<TerminalPost discussion={discussion} lastPost={discussion.lastPostNumber()} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t''\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{Number(settings.showReplies) === 1 ? (\r\n\t\t\t\t\t\t<div className=\"cardSpacer\">\r\n\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\tclassName=\"Replies\"\r\n\t\t\t\t\t\t\t\thref={app.route.discussion(\r\n\t\t\t\t\t\t\t\t\tdiscussion,\r\n\t\t\t\t\t\t\t\t\tdiscussion.lastPostNumber()\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<div className=\"Left\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"Avatars\">\r\n\t\t\t\t\t\t\t\t\t\t{m(LastReplies, {\r\n\t\t\t\t\t\t\t\t\t\t\tdiscussion: discussion,\r\n\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"Repcount\">\r\n\t\t\t\t\t\t\t\t\t\t{replyText}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"Arrow\">\r\n\t\t\t\t\t\t\t\t\t{icon(\"fas fa-angle-right\")}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Link>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import isValideImageUrl from \"./isValideImageUrl\";\r\n\r\nexport default function getPostImage(post, image, isblogPost = false, key = 1) {\r\n\r\n  const regex = /<img(?!.*?class=\"emoji\").*?src=[\\'\"](.*?)[\\'\"].*?>|background(?:-image)?:\\s*url\\(['\"]?(.*?)['\"]?\\)/i;\r\n\r\n  if(isblogPost && isValideImageUrl(image)) {\r\n    return image;\r\n  }\r\n\r\n  const assetImage = app.forum.attribute(\"baseUrl\") + \"/assets/\" + image;\r\n\r\n  if (post) {\r\n    const src = regex.exec(post.contentHtml());\r\n    if (typeof key === \"number\" && key > 0) {\r\n      return (src) ? (src[1] || src[2]) : (image ? assetImage : null);\r\n    } else if (key === '~') {\r\n      return src;\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n}\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/abbreviateNumber'];","import Component from \"flarum/common/Component\";\r\nimport craftBadges from \"../utils/craftBadges\";\r\nimport getPostImage from \"../helpers/getPostImage\";\r\nimport getPostImages from \"../helpers/getPostImages\";\r\nimport highlightHashtags from \"../helpers/highlightHashtags\";\r\nimport craftTags from \"../utils/craftTags\";\r\nimport humanTime from 'flarum/common/utils/humanTime';\r\nimport icon from 'flarum/common/helpers/icon';\r\nimport username from 'flarum/common/helpers/username';\r\nimport Dropdown from 'flarum/common/components/Dropdown';\r\nimport DiscussionControls from 'flarum/forum/utils/DiscussionControls';\r\nimport Link from 'flarum/common/components/Link';\r\nimport {truncate} from 'flarum/common/utils/string';\r\nimport LastReplies from './LastReplies';\r\nimport compareTags from \"../helpers/compareTags\";\r\nimport isValideImageUrl from \"../helpers/isValideImageUrl\";\r\nimport abbreviateNumber from 'flarum/common/utils/abbreviateNumber';\r\nimport TerminalPost from 'flarum/components/TerminalPost';\r\n\r\n\r\nexport default class listItem extends Component {\r\n\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n  }\r\n\r\n  view() {\r\n    const discussion = this.attrs.discussion;\r\n    const settings = {};\r\n    for (const key in app.forum.data.attributes) {\r\n\t\t\tif (key.startsWith('walsgitDiscussionCards')) {\r\n\t\t\t\tlet newKey = key.replace('walsgitDiscussionCards', '');\r\n\t\t\t\tnewKey = newKey.replace(/^./, newKey.charAt(0).toLowerCase());\r\n\t\t\t\tsettings[newKey] = app.forum.data.attributes[key];\r\n\t\t\t}\r\n\t\t}\r\n\r\n    /* Getting & setting relevant info for 3rd party Views extensions support: Flarumite and MichaelBelgium */\r\n\t\tconst viewsActivated = 'flarumite-simple-discussion-views' in flarum.extensions;\r\n\t\tconst isViewsSet = discussion.data.attributes.hasOwnProperty('views');\r\n\r\n\t\tconst mbViewsActivated = 'michaelbelgium-discussion-views' in flarum.extensions;\r\n\t\tconst isViewCountSet = discussion.data.attributes.hasOwnProperty('viewCount');\r\n\r\n\t\tconst viewsCount = viewsActivated && isViewsSet ? discussion.views() : mbViewsActivated && isViewCountSet ? discussion.viewCount() : NaN;\r\n\r\n    /* Getting & setting relevant info for 3rd party Flarum Blog support */\r\n\t\tconst blogActivated = app.forum.data.attributes.hasOwnProperty('blogTags');\r\n\t\tconst blogSettings = {};\r\n\t\tconst postIsBlogType = discussion.data.relationships.hasOwnProperty('blogMeta');\r\n\t\tconst blogPost = {}\r\n\t\tif(blogActivated) {\r\n\t\t\tblogSettings.tags = app.forum.attribute('blogTags');\r\n\t\t\tblogSettings.defaultImage = app.forum.attribute('blogDefaultImage');\r\n\r\n\t\t\tif(postIsBlogType) {\r\n\t\t\t\tconst blogPostsData = discussion.store.data.blogMeta[discussion.data.relationships.blogMeta.data.id];\r\n\t\t\t\tif(isValideImageUrl(blogPostsData.attribute('featuredImage'))) {\r\n\t\t\t\t\tblogPost.featuredImage = blogPostsData.attribute('featuredImage');\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n    /* Getting & setting relevant info for 3rd party Repost extension */\r\n    const repostActivated = 'shebaoting-repost' in flarum.extensions;\r\n    const repostUrl = discussion.data.attributes.original_url || null;\r\n\r\n    const isTagPage = m.route.get().split('?')[0].startsWith('/t/');\r\n\t\tif (isTagPage) {\r\n      const slug = m.route.get().split('/t/')[1]?.split('?')[0];\r\n      const tagId = app.store.all('tags').find(t => t.slug() === slug).data.id;\r\n      const tag = app.store.all('tags').find(t => t.id() === tagId);\r\n      const tagSettings = tag ? JSON.parse(tag.data.attributes.walsgitDiscussionCardsTagSettings || '{}') : {};\r\n      const tagImage = tag ? tag.data.attributes.walsgitDiscussionCardsTagDefaultImage : null;\r\n      \r\n      tagSettings.defaultImage = tagImage;\r\n      /* In case Flarum Blog Extension and useBlogImage are activated  */\r\n      if(blogActivated && Number(settings.useBlogImages) === 1 && blogSettings.tags.includes(tagId)) {\r\n\t\t\t\ttagSettings.defaultImage = postIsBlogType && blogPost.featuredImage && isValideImageUrl(blogPost.featuredImage) ? blogPost.featuredImage : blogSettings.defaultImage;\r\n\t\t\t}\r\n\r\n      for (const key in tagSettings) {\r\n        if (settings.hasOwnProperty(key) && tagSettings[key] !== settings[key] && tagSettings[key] !== null) {\r\n          settings[key] = tagSettings[key];\r\n        }\r\n      }\r\n    }\r\n\r\n    /* On the IndexPage (all discussions) checks which default image to show based on tag priority */\r\n\t\tconst isIndexPage = m.route.get().split('?')[0] === '/';\r\n\t\tif (isIndexPage) {\r\n\t\t\tconst tags = discussion.tags();\r\n\t\t\tfor (const key in tags) {\r\n\t\t\t\tconst tagId = tags[key].id();\r\n\t\t\t\tconst isChild = tags[key].isChild();\r\n\t\t\t\tconst parent = tags[key].data.hasOwnProperty('relationships') && tags[key].parent() ? tags[key].parent()['data'].id : null;\r\n\t\t\t\tconst position = tags[key].position();\r\n\r\n\t\t\t\tlet tagCustomImg = tags[key].attribute('walsgitDiscussionCardsTagDefaultImage');\r\n        /* In case Flarum Blog Extension and useBlogImage are activated  */\r\n\t\t\t\tif(blogActivated && Number(settings.useBlogImages) === 1 && blogSettings.tags.includes(tagId)) {\r\n\t\t\t\t\ttagCustomImg = postIsBlogType && blogPost.featuredImage && isValideImageUrl(blogPost.featuredImage) ? blogPost.featuredImage : blogSettings.defaultImage;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst currentTag = { id: tagId, isChild, parent, position, tagCustomImg }\r\n\t\t\t\tlet priorityTag = null;\r\n\t\t\t\tif (!settings.allowedTags.includes(tagId) || tagCustomImg === null)\tcontinue;\r\n\r\n\t\t\t\tif (priorityTag === null || compareTags(currentTag, priorityTag) < 0) {\r\n\t\t\t\t\tpriorityTag = { id: tagId, isChild, parent, position, tagCustomImg };\r\n\t\t\t\t\tsettings.defaultImage = tagCustomImg;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n    const isRead = Number(settings.markReadCards) === 1 && (discussion.isRead() && app.session.user) ? 'read' : '';\r\n    \r\n    // 获取列表卡片最大图片数量设置（默认为3）\r\n    const maxListImages = Number(settings.maxListImages) || 3;\r\n    \r\n    // 获取最后一个标签的颜色用于左侧色条\r\n    const tags = discussion.tags();\r\n    const lastTag = tags && tags.length > 0 ? tags[tags.length - 1] : null;\r\n    const tagColor = lastTag ? lastTag.color() : '#ddd';\r\n    \r\n    // 获取多张图片\r\n    const images = getPostImages(discussion.firstPost(), settings.defaultImage, postIsBlogType, maxListImages);\r\n    const hasImages = images.length > 0;\r\n\r\n    /* Jump to the last relevant post (first unread or last post) */\r\n    const jumpTo = Math.min(discussion.lastPostNumber() ?? 0, (discussion.lastReadPostNumber() || 0) + 1);\r\n\r\n    /* setting post counts & text */\r\n\t\tconst replyText = discussion.unreadCount() \r\n\t\t\t? app.translator.trans(\"walsgit_discussion_cards.forum.unreadReplies\", { count: discussion.unreadCount()} ) \r\n\t\t\t: app.translator.trans(\"walsgit_discussion_cards.forum.replies\", { count: discussion.replyCount() || \"0\"} );\r\n    const postCount = discussion.unreadCount() ? discussion.unreadCount() + \"*\" : discussion.replyCount();\r\n\r\n    return (\r\n      <div key={discussion.id()}\r\n          data-id={discussion.id()}\r\n          className={\"CardsListItem List \" + isRead + (discussion.isHidden() ? \" Hidden\" : \"\")}\r\n          style={`--tag-color: ${tagColor}`}>\r\n        {DiscussionControls.controls(discussion, this).toArray().length\r\n          ? m(Dropdown, {\r\n            icon: 'fas fa-ellipsis-v',\r\n            className: 'DiscussionListItem-controls',\r\n            buttonClassName: 'Button Button--icon Button--flat Slidable-underneath Slidable-underneath--right',\r\n          }, DiscussionControls.controls(discussion, this).toArray())\r\n          : ''}\r\n        <Link href={app.route.discussion(discussion, jumpTo)}\r\n              className=\"cardLink\">\r\n\r\n          <div className=\"listCardContent\">\r\n            {/* 顶部：徽章 + 标签 + 标题（智能一行布局，空间不足时标题自动换行） */}\r\n            <div className=\"listCardHeader\">\r\n              <div className=\"listHeaderRow\">\r\n                {/* 徽章 */}\r\n                {Number(settings.showBadges) === 1 && craftBadges(discussion.badges().toArray())}\r\n                \r\n                {/* 标签 */}\r\n                <div className=\"cardTags\">{craftTags(discussion.tags())}</div>\r\n                \r\n                {/* 标题 */}\r\n                <div className=\"cardTitle\">\r\n                  <h2 title={discussion.title()} className=\"title\">\r\n                    {Number(settings.allowRepostLinks) === 1 && repostActivated && repostUrl ? \r\n                      <a href={repostUrl} onclick={(e) => e.stopPropagation()}>{truncate(discussion.title(), 80)}</a> : \r\n                      truncate(discussion.title(), 80)\r\n                    }\r\n                  </h2>\r\n                  {app.screen() !== 'phone' && Number(settings.showReplies) === 1 && Number(settings.showRepliesOnRight) === 1 ?\r\n                    <div className=\"DiscussionListItem-count\">\r\n                      <span aria-hidden=\"true\">{abbreviateNumber(postCount)}</span>\r\n                      <span className=\"visually-hidden\">\r\n                        {app.translator.trans('core.forum.discussion_list.unread_replies_a11y_label', { count: discussion.replyCount() })}\r\n                      </span>\r\n                    </div>\r\n                  : ''}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* 预览文本 */}\r\n            {Number(settings.previewText) === 1 && discussion.firstPost() ? (\r\n              <div className=\"previewPost\">\r\n                {m.trust(highlightHashtags(\r\n                  blogActivated && Number(settings.useBlogSummary) === 1 && discussion.data.relationships.hasOwnProperty('blogMeta') && discussion.blogMeta().summary() !== ''\r\n                    ? truncate(discussion.blogMeta().summary(), 300)\r\n                    : truncate(discussion.firstPost().contentPlain(), 300)\r\n                ))}\r\n              </div>\r\n            ) : ''}\r\n\r\n            {/* 图片网格 - 在内容下方横向显示 */}\r\n            {hasImages && (\r\n              <div className=\"listImagesRow\">\r\n                {images.map((img, index) => (\r\n                  <img \r\n                    key={index}\r\n                    src={img}\r\n                    className=\"listImageThumb\"\r\n                    alt={discussion.title()}\r\n                    loading=\"lazy\"\r\n                  />\r\n                ))}\r\n              </div>\r\n            )}\r\n\r\n            {/* 作者、回复数和时间信息 */}\r\n            {Number(settings.showAuthor) === 1 && (\r\n              <div className=\"listCardFooter\">\r\n                <div className=\"listMetaInfo\">\r\n                  <span className=\"listAuthor\">{username(discussion.user())}</span>\r\n                  \r\n                  {Number(settings.showReplies) === 1 && (\r\n                    <span className=\"listReplies\">\r\n                      {icon('fas fa-comment', {className: 'listIcon'})}\r\n                      <span>{postCount}</span>\r\n                    </span>\r\n                  )}\r\n                  \r\n                  <span className=\"listDate\">{humanTime(discussion.createdAt())}</span>\r\n                </div>\r\n                \r\n                {(isViewsSet || isViewCountSet) && Number(settings.showViews) === 1 && !isNaN(viewsCount) && (\r\n                  <div className=\"listViews\">\r\n                    {icon('fas fa-eye', {className: 'listIcon'})}\r\n                    <span>{viewsCount}</span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n              \r\n            {Number(settings.showLastPostInfo) === 1 && discussion.firstPost() ? (\r\n              <div className=\"terminalPost\">\r\n                <TerminalPost discussion={discussion} lastPost={discussion.lastPostNumber()} />\r\n              </div>\r\n            ) : ''}\r\n          </div>\r\n        </Link>\r\n      </div>\r\n    );\r\n\r\n  }\r\n\r\n}\r\n","/**\r\n * 高亮显示文本中的 #标签 和 电话号码\r\n * @param {string} text - 原始文本\r\n * @returns {string} - 包含HTML标记的文本\r\n */\r\nexport default function highlightHashtags(text) {\r\n  if (!text) return '';\r\n  \r\n  // HTML转义，防止XSS\r\n  const escapeHtml = (str) => {\r\n    return str\r\n      .replace(/&/g, '&amp;')\r\n      .replace(/</g, '&lt;')\r\n      .replace(/>/g, '&gt;')\r\n      .replace(/\"/g, '&quot;')\r\n      .replace(/'/g, '&#039;');\r\n  };\r\n  \r\n  const escaped = escapeHtml(text);\r\n  \r\n  // 先匹配电话号码（11位连续数字，前后不能是数字）\r\n  // 使用负向前瞻和负向后顾确保不是更长数字的一部分\r\n  const phoneRegex = /(?<!\\d)(\\d{11})(?!\\d)/g;\r\n  let result = escaped.replace(phoneRegex, '<span class=\"hashtag\">$1</span>');\r\n  \r\n  // 再匹配 #标签（#开头，到空格、标点或结尾）\r\n  // 支持中英文、数字、下划线\r\n  const hashtagRegex = /#([^\\s#<>，。！？、；：\"\"''（）]+)/g;\r\n  result = result.replace(hashtagRegex, '<span class=\"hashtag\">#$1</span>');\r\n  \r\n  return result;\r\n}\r\n","import isValideImageUrl from \"./isValideImageUrl\";\r\n\r\n/**\r\n * 从帖子内容中提取多张图片\r\n * @param {Object} post - 帖子对象\r\n * @param {string} defaultImage - 默认图片路径\r\n * @param {boolean} isBlogPost - 是否为博客帖子\r\n * @param {number} maxImages - 最多提取图片数量（0-5）\r\n * @returns {Array} 图片URL数组\r\n */\r\nexport default function getPostImages(post, defaultImage, isBlogPost = false, maxImages = 3) {\r\n  const images = [];\r\n  \r\n  // 如果是博客帖子且有有效的默认图片，优先使用\r\n  if (isBlogPost && isValideImageUrl(defaultImage)) {\r\n    images.push(defaultImage);\r\n    if (maxImages === 1) return images;\r\n  }\r\n  \r\n  // 如果没有帖子内容，返回默认图片或空数组\r\n  if (!post) {\r\n    if (defaultImage && !isBlogPost) {\r\n      const assetImage = app.forum.attribute(\"baseUrl\") + \"/assets/\" + defaultImage;\r\n      images.push(assetImage);\r\n    }\r\n    return images;\r\n  }\r\n  \r\n  // 正则表达式匹配所有图片（排除emoji）\r\n  const regex = /<img(?!.*?class=\"emoji\").*?src=[\\'\"](.*?)[\\'\"].*?>/gi;\r\n  const content = post.contentHtml();\r\n  \r\n  let match;\r\n  let count = isBlogPost && images.length > 0 ? 1 : 0; // 如果已经添加了博客图片，从1开始计数\r\n  \r\n  // 提取所有图片URL\r\n  while ((match = regex.exec(content)) !== null && count < maxImages) {\r\n    const imageUrl = match[1];\r\n    if (imageUrl && !images.includes(imageUrl)) {\r\n      images.push(imageUrl);\r\n      count++;\r\n    }\r\n  }\r\n  \r\n  // 如果没有找到图片且有默认图片，添加默认图片\r\n  if (images.length === 0 && defaultImage) {\r\n    const assetImage = app.forum.attribute(\"baseUrl\") + \"/assets/\" + defaultImage;\r\n    images.push(assetImage);\r\n  }\r\n  \r\n  return images;\r\n}\r\n","export default function checkOverflowingTags() {\r\n    const cardListItemsOnPrimary = document.querySelectorAll(\".CardsListItem.Card .cardLink\");\r\n    const cardListItems = document.querySelectorAll(\".cardGrid .colSpan-2\");\r\n\r\n    const toggleOverflowClass = function(cardTags, cardListItem) {\r\n        if (!cardTags) return;\r\n\r\n        if (cardTags.scrollWidth > cardListItem.clientWidth - 30) { // -30 to account for the 15px + 15px margins on .cardTags\r\n        cardTags.classList.add(\"overflowing\");\r\n        } else {\r\n        cardTags.classList.remove(\"overflowing\");\r\n        }\r\n    }\r\n\r\n    cardListItemsOnPrimary.forEach(cardListItem => {\r\n        const cardTags = cardListItem.querySelector(\".cardTags\");\r\n\r\n        toggleOverflowClass(cardTags, cardListItem);\r\n    });\r\n\r\n    cardListItems.forEach(cardListItem => {\r\n        const cardTags = cardListItem.querySelector(\".flexBox .cardTags\");\r\n\r\n        toggleOverflowClass(cardTags, cardListItem);\r\n    });\r\n}","import CardItem from './components/CardItem';\r\nimport ListItem from './components/ListItem';\r\nimport LastReplies from './components/LastReplies';\r\nimport craftTags from \"./utils/craftTags\";\r\nimport craftBadges from \"./utils/craftBadges\";\r\n\r\nexport default {\r\n  'walsgit/discussion/cards/components/CardItem': CardItem,\r\n  'walsgit/discussion/cards/components/ListItem': ListItem,\r\n  'walsgit/discussion/cards/components/LastReplies': LastReplies,\r\n  'walsgit/discussion/cards/utils/craftTags': craftTags,\r\n  'walsgit/discussion/cards/utils/craftBadges': craftBadges,\r\n};\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core;","import app from 'flarum/app';\r\nimport {extend, override} from 'flarum/extend';\r\nimport DiscussionList from 'flarum/forum/components/DiscussionList';\r\nimport DiscussionListState from 'flarum/forum/states/DiscussionListState';\r\nimport IndexPage from 'flarum/forum/components/IndexPage';\r\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\r\nimport Placeholder from 'flarum/common/components/Placeholder';\r\nimport Button from 'flarum/common/components/Button';\r\nimport CardItem from './components/CardItem';\r\nimport ListItem from './components/ListItem';\r\nimport checkOverflowingTags from './helpers/checkOverflowingTags';\r\n\r\napp.initializers.add('aoang-git-discussion-cards', () => {\r\n\r\n  extend(DiscussionList.prototype, 'oncreate', checkOverflowingTags);\r\n  extend(DiscussionList.prototype, 'onupdate', checkOverflowingTags);\r\n\r\n  extend(DiscussionListState.prototype, 'requestParams', function (params) {\r\n    if (app.current.matches(IndexPage)) {\r\n      params.include.push(['firstPost', 'posts', 'posts.user']);\r\n    }\r\n  });\r\n\r\n  override(DiscussionList.prototype, 'view', function (original) {\r\n    const settings = {};\r\n    for (const key in app.forum.data.attributes) {\r\n      if (key.startsWith('walsgitDiscussionCards')) {\r\n        let newKey = key.replace('walsgitDiscussionCards', '');\r\n        newKey = newKey.replace(/^./, newKey.charAt(0).toLowerCase());\r\n        settings[newKey] = app.forum.data.attributes[key];\r\n      }\r\n    }\r\n    const state = this.attrs.state;\r\n    const params = state.getParams();\r\n    let loading;\r\n    if (state.isInitialLoading() || state.isLoadingNext()) {\r\n      loading = <LoadingIndicator/>;\r\n    } else if (state.hasNext()) {\r\n      loading = Button.component(\r\n        {\r\n          className: 'Button',\r\n          onclick: state.loadNext.bind(state),\r\n        },\r\n        app.translator.trans('core.forum.discussion_list.load_more_button')\r\n      );\r\n    }\r\n    if (state.isEmpty()) {\r\n      const text = app.translator.trans('core.forum.discussion_list.empty_text');\r\n      return <div className=\"DiscussionList\">{m(Placeholder, {text})}</div>;\r\n    }\r\n    const isTagPage = m.route.get().split('?')[0].startsWith('/t/');\r\n    let tag = null;\r\n    if (isTagPage) {\r\n      tag = app.store.all('tags').find(t => t.slug() === params.tags).data.id;\r\n      const tagSettings = JSON.parse(app.store.all('tags').find(t => t.slug() === params.tags).data.attributes.walsgitDiscussionCardsTagSettings);\r\n      for (const key in tagSettings) {\r\n        if (settings.hasOwnProperty(key) && tagSettings[key] !== settings[key]) {\r\n          settings[key] = tagSettings[key];\r\n        }\r\n      }\r\n    }\r\n    if (app.current.matches(IndexPage) && ((settings.allowedTags.length && settings.allowedTags.includes(tag)) || (!params.tags && Number(settings.onIndexPage) === 1))) {\r\n      return (\r\n        <div className={'DiscussionList' + (state.isSearchResults() ? ' DiscussionList--searchResults' : '')}>\r\n          <div class=\"DiscussionList-discussions flexCard\">\r\n            {state.getPages().map((pg, o) => {\r\n              return pg.items.map((discussion, i) => {\r\n                return (i < Number(settings.primaryCards) && o === 0)\r\n                  ? m(CardItem, {discussion: discussion})\r\n                  : m(ListItem, {discussion: discussion})\r\n              });\r\n            })}\r\n          </div>\r\n          <div className=\"DiscussionList-loadMore\">{loading}</div>\r\n        </div>\r\n      );\r\n\r\n    } else {\r\n      return original();\r\n    }\r\n  })\r\n}, -1);\r\n\r\n\r\n// Expose compat API\r\nimport extCompat from './compat';\r\nimport {compat} from '@flarum/core/forum';\r\n\r\nObject.assign(compat, extCompat);\r\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","core","compat","_setPrototypeOf","t","e","setPrototypeOf","bind","__proto__","_inheritsLoose","create","constructor","craftBadges","badges","length","m","map","badge","Tooltip","text","attrs","label","position","type","icon","isValideImageUrl","url","parsedUrl","startsWith","URL","_unused","extension","pathname","split","pop","toLowerCase","includes","craftTags","tags","sortTags","tag","Link","className","style","backgroundColor","color","href","app","route","slug","name","LastReplies","_Component","apply","arguments","_proto","oninit","vnode","this","discussion","view","posts","splice","filter","post","isHidden","number","contentType","sort","b","createdAt","user","i","self","indexOf","reverse","avatar","Component","compareTags","currentTag","priorityTag","isChild","parent","id","cardItem","_discussion$lastPostN","settings","forum","data","attributes","newKey","replace","charAt","viewsActivated","extensions","isViewsSet","mbViewsActivated","isViewCountSet","viewsCount","views","viewCount","NaN","blogActivated","blogSettings","postIsBlogType","relationships","blogPost","attribute","defaultImage","blogPostsData","store","blogMeta","featuredImage","tagId","repostActivated","repostUrl","original_url","isTagPage","_m$route$get$split$","all","find","tagSettings","JSON","parse","walsgitDiscussionCardsTagSettings","tagImage","walsgitDiscussionCardsTagDefaultImage","Number","useBlogImages","tagCustomImg","allowedTags","isRead","markReadCards","session","showAuthor","image","isblogPost","assetImage","src","exec","contentHtml","getPostImage","firstPost","media","alt","title","loading","jumpTo","Math","min","lastPostNumber","lastReadPostNumber","replyText","unreadCount","translator","trans","count","replyCount","DiscussionControls","toArray","Dropdown","buttonClassName","showBadges","'['","showViews","isNaN","username","humanTime","allowRepostLinks","onclick","stopPropagation","truncate","previewText","useBlogSummary","summary","contentPlain","showLastPostInfo","TerminalPost","lastPost","showReplies","listItem","maxListImages","lastTag","tagColor","images","isBlogPost","maxImages","push","match","regex","content","imageUrl","getPostImages","hasImages","postCount","screen","showRepliesOnRight","abbreviateNumber","trust","img","index","checkOverflowingTags","cardListItemsOnPrimary","document","querySelectorAll","cardListItems","toggleOverflowClass","cardTags","cardListItem","scrollWidth","clientWidth","classList","add","remove","forEach","querySelector","CardItem","ListItem","extend","DiscussionList","DiscussionListState","params","matches","IndexPage","include","override","original","state","getParams","isInitialLoading","isLoadingNext","LoadingIndicator","hasNext","Button","loadNext","isEmpty","Placeholder","onIndexPage","isSearchResults","class","getPages","pg","items","primaryCards","assign","extCompat"],"sourceRoot":""}